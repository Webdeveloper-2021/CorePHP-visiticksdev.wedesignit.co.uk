<?php

///*****************************************************************************///
///UNIVERSAL PAGE CODE: COPYRIGHT NOTICE?///
///*****************************************************************************///
///*****************************************************************************///
///ALLOW ALL ACCESS///
///*****************************************************************************///

	header('Content-Type: application/json');

///*****************************************************************************///
///UNIVERSAL PAGE CODE: LOAD INCLUDED FILES///
///*****************************************************************************///

	require("includes/visitickets.php");
    use includes\classes\models\Order;

///*****************************************************************************///
///UNIVERSAL PAGE CODE: GET AND CLEAN VARIABLES///
///*****************************************************************************///

	$orderid = $_POST['id'];

///*****************************************************************************///
///RESET ERRORS///
///*****************************************************************************///

	$error = false;

	$response = array(
	    "completed" => "",
        "error" => ""
    );

///*****************************************************************************///
///CHECK DATA///
///*****************************************************************************///

        if (empty($orderid)) {
            $error = true;
        }

		if(!$error)
		{
		    $order = new Order($orderid);

		    if ($order->sendConfirmationEmail()) {
                $response["completed"] = true;
            } else {
                $response["error"] = SETTING_GENERIC_ERROR_MSG;
            }
		}
		else
		{
		$response["error"] = "Order ID not defined.";
		}

	echo json_encode($response);